<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Spatial plots of discrete or continuous features for stitched-together capture areas. — spot_plot • visiumStitched</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js" integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><link href="../extra.css" rel="stylesheet"><meta property="og:title" content="Spatial plots of discrete or continuous features for stitched-together capture areas. — spot_plot"><meta property="og:description" content="This function is essentially a wrapper around spatialLIBD::vis_clus and
spatialLIBD::vis_gene, suitable for merged samples (each sample in the
SpatialExperiment 'spe' is a donor consisting of multiple capture areas, with
colData column 'exclude_overlapping' indicating overlapping spots to drop (to
prevent overplotting)."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">visiumStitched</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.99.0</span>
      </span>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../articles/visiumStitched.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://github.com/LieberInstitute/visiumStitched/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->
      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Spatial plots of discrete or continuous features for stitched-together capture areas.</h1>
    <small class="dont-index">Source: <a href="https://github.com/LieberInstitute/visiumStitched/blob/devel/R/spot_plot.R" class="external-link"><code>R/spot_plot.R</code></a></small>
    <div class="hidden name"><code>spot_plot.Rd</code></div>
    </div>
    <div class="ref-description">
    <p>This function is essentially a wrapper around <code><a href="https://rdrr.io/pkg/spatialLIBD/man/vis_clus.html" class="external-link">spatialLIBD::vis_clus</a></code> and
<code><a href="https://rdrr.io/pkg/spatialLIBD/man/vis_gene.html" class="external-link">spatialLIBD::vis_gene</a></code>, suitable for merged samples (each sample in the
SpatialExperiment 'spe' is a donor consisting of multiple capture areas, with
colData column 'exclude_overlapping' indicating overlapping spots to drop (to
prevent overplotting).</p>
    </div>
    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">spot_plot</span><span class="op">(</span></span>
<span>  <span class="va">spe</span>,</span>
<span>  <span class="va">sample_id</span>,</span>
<span>  image_id <span class="op">=</span> <span class="st">"lowres"</span>,</span>
<span>  title <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sprintf.html" class="external-link">sprintf</a></span><span class="op">(</span><span class="st">"%s_%s"</span>, <span class="va">sample_id</span>, <span class="va">var_name</span><span class="op">)</span>,</span>
<span>  <span class="va">var_name</span>,</span>
<span>  multi_gene_method <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"z_score"</span>, <span class="st">"pca"</span>, <span class="st">"sparsity"</span><span class="op">)</span>,</span>
<span>  include_legend <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  <span class="va">is_discrete</span>,</span>
<span>  colors <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  assayname <span class="op">=</span> <span class="st">"logcounts"</span>,</span>
<span>  minCount <span class="op">=</span> <span class="fl">0.5</span>,</span>
<span>spatial <span class="op">=</span> <span class="cn">FALSE</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>
    <div id="arguments">
    <h2>Arguments</h2>
<dl><dt id="arg-spe">spe<a class="anchor" aria-label="anchor" href="#arg-spe"></a></dt>
<dd><p>A <code>SpatialExperiment</code> with colData column <code>exclude_overlapping</code>,
passed to <code><a href="https://rdrr.io/pkg/spatialLIBD/man/vis_gene.html" class="external-link">spatialLIBD::vis_gene</a></code> or <code><a href="https://rdrr.io/pkg/spatialLIBD/man/vis_clus.html" class="external-link">spatialLIBD::vis_clus</a></code></p></dd>
<dt id="arg-sample-id">sample_id<a class="anchor" aria-label="anchor" href="#arg-sample-id"></a></dt>
<dd><p>character(1) passed to <code>sampleid</code> in
<code><a href="https://rdrr.io/pkg/spatialLIBD/man/vis_gene.html" class="external-link">spatialLIBD::vis_gene</a></code> or <code><a href="https://rdrr.io/pkg/spatialLIBD/man/vis_clus.html" class="external-link">spatialLIBD::vis_clus</a></code>. Assumed to be a
donor, possibly consisting of several capture areas to plot at once</p></dd>
<dt id="arg-image-id">image_id<a class="anchor" aria-label="anchor" href="#arg-image-id"></a></dt>
<dd><p>character(1) giving the name of the image (e.g. "lowres") to
plot, used both to determine an appropriate spot size and passed to
<code><a href="https://rdrr.io/pkg/spatialLIBD/man/vis_gene.html" class="external-link">spatialLIBD::vis_gene</a></code> or <code><a href="https://rdrr.io/pkg/spatialLIBD/man/vis_clus.html" class="external-link">spatialLIBD::vis_clus</a></code></p></dd>
<dt id="arg-title">title<a class="anchor" aria-label="anchor" href="#arg-title"></a></dt>
<dd><p>character(1) giving the title of the plot</p></dd>
<dt id="arg-var-name">var_name<a class="anchor" aria-label="anchor" href="#arg-var-name"></a></dt>
<dd><p>character() passed to <code>geneid</code> for <code><a href="https://rdrr.io/pkg/spatialLIBD/man/vis_gene.html" class="external-link">spatialLIBD::vis_gene</a></code>
or character(1) passed to <code>clustervar</code> for <code><a href="https://rdrr.io/pkg/spatialLIBD/man/vis_clus.html" class="external-link">spatialLIBD::vis_clus</a></code></p></dd>
<dt id="arg-multi-gene-method">multi_gene_method<a class="anchor" aria-label="anchor" href="#arg-multi-gene-method"></a></dt>
<dd><p>A <code>character(1)</code>: either "pca", "sparsity", or
"z_score". This parameter controls how multiple continuous variables are
combined for visualization, and only applies when <code>var_name</code> has length &gt; 1
and <code>is_discrete</code> is FALSE</p></dd>
<dt id="arg-include-legend">include_legend<a class="anchor" aria-label="anchor" href="#arg-include-legend"></a></dt>
<dd><p>logical(1): if FALSE, remove the plot legend</p></dd>
<dt id="arg-is-discrete">is_discrete<a class="anchor" aria-label="anchor" href="#arg-is-discrete"></a></dt>
<dd><p>logical(1): if TRUE, use <code><a href="https://rdrr.io/pkg/spatialLIBD/man/vis_clus.html" class="external-link">spatialLIBD::vis_clus</a></code>;
otherwise, use <code><a href="https://rdrr.io/pkg/spatialLIBD/man/vis_gene.html" class="external-link">spatialLIBD::vis_gene</a></code></p></dd>
<dt id="arg-colors">colors<a class="anchor" aria-label="anchor" href="#arg-colors"></a></dt>
<dd><p>character() of colors passed to <code>colors</code> for <code><a href="https://rdrr.io/pkg/spatialLIBD/man/vis_clus.html" class="external-link">spatialLIBD::vis_clus</a></code>
if <code>is_discrete</code> or otherwise to <code>cont_colors</code> for <code><a href="https://rdrr.io/pkg/spatialLIBD/man/vis_gene.html" class="external-link">spatialLIBD::vis_gene</a></code></p></dd>
<dt id="arg-assayname">assayname<a class="anchor" aria-label="anchor" href="#arg-assayname"></a></dt>
<dd><p>character(1) passed to <code><a href="https://rdrr.io/pkg/spatialLIBD/man/vis_gene.html" class="external-link">spatialLIBD::vis_gene</a></code> if
not <code>is_discrete</code></p></dd>
<dt id="arg-mincount">minCount<a class="anchor" aria-label="anchor" href="#arg-mincount"></a></dt>
<dd><p>numeric(1) passed to passed to <code><a href="https://rdrr.io/pkg/spatialLIBD/man/vis_gene.html" class="external-link">spatialLIBD::vis_gene</a></code> if
not <code>is_discrete</code></p></dd>
<dt id="arg-spatial">spatial<a class="anchor" aria-label="anchor" href="#arg-spatial"></a></dt>
<dd><p>logical(1) passed to <code>sampleid</code> in
<code><a href="https://rdrr.io/pkg/spatialLIBD/man/vis_gene.html" class="external-link">spatialLIBD::vis_gene</a></code> or <code><a href="https://rdrr.io/pkg/spatialLIBD/man/vis_clus.html" class="external-link">spatialLIBD::vis_clus</a></code></p></dd>
</dl></div>
    <div id="value">
    <h2>Value</h2>
    <p>A <code>ggplot</code> object containing a "spot plot" of the specified sample</p>
    </div>
    <div id="details">
    <h2>Details</h2>
    <p>Spot sizes are <em>almost</em> consistent among donors, regardless of full-
resolution image dimensions, when title is NULL, include_legend is FALSE,
and the plot is saved to a square output (e.g. PDF with 7in width and
height). However, ggplot does not seem to scale plots of different aspect
ratios exactly consistently when writing to PDF (untested for other formats)</p>
    </div>
    <div id="author">
    <h2>Author</h2>
    <p>Nicholas J. Eagles</p>
    </div>
    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">#   Grab an example SpatialExperiment and suppose all of its spots should be</span></span></span>
<span class="r-in"><span><span class="co">#   plotted (for spatialNAc, 'exclude_overlapping' will only have genuinely</span></span></span>
<span class="r-in"><span><span class="co">#   overlapping spots be TRUE)</span></span></span>
<span class="r-in"><span><span class="va">spe</span> <span class="op">&lt;-</span> <span class="kw">if</span> <span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/exists.html" class="external-link">exists</a></span><span class="op">(</span><span class="st">"spe"</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span></span>
<span class="r-in"><span>    <span class="fu">spatialLIBD</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/spatialLIBD/man/fetch_data.html" class="external-link">fetch_data</a></span><span class="op">(</span>type <span class="op">=</span> <span class="st">"spatialDLPFC_Visium_example_subset"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">}</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> 2024-06-05 20:23:32.199884 loading file /github/home/.cache/R/BiocFileCache/adf8de82fa_spatialDLPFC_spe_subset_example.rds%3Fdl%3D1</span>
<span class="r-in"><span><span class="va">spe</span><span class="op">$</span><span class="va">exclude_overlapping</span> <span class="op">&lt;-</span> <span class="cn">FALSE</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">#   Plot age spatially for the first sample</span></span></span>
<span class="r-in"><span><span class="va">sample_id</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="va">spe</span><span class="op">$</span><span class="va">sample_id</span><span class="op">)</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span></span></span>
<span class="r-in"><span><span class="va">p</span> <span class="op">&lt;-</span> <span class="fu">spot_plot</span><span class="op">(</span></span></span>
<span class="r-in"><span>    <span class="va">spe</span>,</span></span>
<span class="r-in"><span>    sample_id <span class="op">=</span> <span class="va">sample_id</span>,</span></span>
<span class="r-in"><span>    title <span class="op">=</span> <span class="va">sample_id</span>, var_name <span class="op">=</span> <span class="st">"age"</span>,</span></span>
<span class="r-in"><span>    include_legend <span class="op">=</span> <span class="cn">TRUE</span>, is_discrete <span class="op">=</span> <span class="cn">FALSE</span>, minCount <span class="op">=</span> <span class="fl">0</span>,</span></span>
<span class="r-in"><span>    assayname <span class="op">=</span> <span class="st">"logcounts"</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">p</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="spot_plot-1.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">#    Define several markers for white matter</span></span></span>
<span class="r-in"><span><span class="va">white_matter_genes</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>    <span class="st">"ENSG00000197971"</span>, <span class="st">"ENSG00000131095"</span>, <span class="st">"ENSG00000123560"</span>,</span></span>
<span class="r-in"><span>    <span class="st">"ENSG00000171885"</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">#   Plot multiple white matter genes simultaneously for the first sample.</span></span></span>
<span class="r-in"><span><span class="co">#   Use the "pca" method for combining them</span></span></span>
<span class="r-in"><span><span class="va">p</span> <span class="op">&lt;-</span> <span class="fu">spot_plot</span><span class="op">(</span></span></span>
<span class="r-in"><span>    <span class="va">spe</span>,</span></span>
<span class="r-in"><span>    sample_id <span class="op">=</span> <span class="va">sample_id</span>,</span></span>
<span class="r-in"><span>    title <span class="op">=</span> <span class="va">sample_id</span>, var_name <span class="op">=</span> <span class="va">white_matter_genes</span>,</span></span>
<span class="r-in"><span>    multi_gene_method <span class="op">=</span> <span class="st">"pca"</span>, include_legend <span class="op">=</span> <span class="cn">TRUE</span>, is_discrete <span class="op">=</span> <span class="cn">FALSE</span>,</span></span>
<span class="r-in"><span>    minCount <span class="op">=</span> <span class="fl">0</span>, assayname <span class="op">=</span> <span class="st">"logcounts"</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">p</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="spot_plot-2.png" alt="" width="700" height="433"></span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>
      <footer><div class="copyright">
  <p></p><p>Developed by Nicholas J. Eagles.</p>
</div>
<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.9.9000.</p>
</div>
      </footer></div>
  </body></html>

